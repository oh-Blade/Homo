# 心路历程 Android 版 — 运行与编译指南

本文档说明从打开项目到在 Android Studio 中编译、运行的完整步骤。

---

## 一、环境准备

### 1.1 必需软件

| 项目 | 要求 |
|------|------|
| **Android Studio** | Ladybug (2024.2.1) 或更高版本 |
| **JDK** | 17（Android Studio 一般自带，需在设置中确认） |
| **Android SDK** | API 24+（minSdk 24），建议安装 API 34（targetSdk 34） |

### 1.2 检查 JDK 版本

- 菜单 **File → Settings**（macOS：**Android Studio → Settings**）
- **Build, Execution, Deployment → Build Tools → Gradle**
- **Gradle JDK** 选择 **17** 或 **jbr-17**（JetBrains Runtime 17）

### 1.3 安装 Android SDK 组件

- 菜单 **Tools → SDK Manager**
- **SDK Platforms**：勾选 **Android 14.0 (API 34)** 或项目 targetSdk 所需版本
- **SDK Tools**：确保已安装 **Android SDK Build-Tools**、**Android SDK Platform-Tools**

---

## 二、打开项目

1. 启动 **Android Studio**。
2. 选择 **Open**（或 **File → Open**）。
3. 选中并打开 **`homo_android`** 文件夹（即包含 `build.gradle.kts`、`app/`、`settings.gradle.kts` 的目录）。
4. 不要选上一级的父目录，必须选 **`homo_android`** 本身。

---

## 三、Gradle 同步

打开项目后，Android Studio 通常会提示同步 Gradle：

1. 若顶部出现 **「Sync Now」** 或 **「Gradle sync failed」**，点击 **Sync Now**。
2. 或手动同步：菜单 **File → Sync Project with Gradle Files**（或工具栏大象图标）。
3. 等待同步完成（右下角进度条），首次会下载 Gradle 与依赖，可能需几分钟。
4. 若项目中没有 `gradlew`：
   - 菜单 **File → Settings → Build, Execution, Deployment → Build Tools → Gradle**
   - **Use Gradle from** 选择 **‘gradle-wrapper.properties’ file**，由 IDE 使用 wrapper 配置下载 Gradle。

---

## 四、编译项目

### 4.1 菜单编译

- **Build → Make Project**（快捷键 **Ctrl+F9** / **Cmd+F9**）  
  仅编译，不安装到设备。

- **Build → Build Bundle(s) / APK(s) → Build APK(s)**  
  生成 Debug APK，输出在：  
  `app/build/outputs/apk/debug/app-debug.apk`

### 4.2 命令行编译（可选）

若已存在 `gradlew`（或从其他项目复制到 `homo_android` 根目录）：

```bash
cd homo_android
./gradlew assembleDebug
```

生成同上：`app/build/outputs/apk/debug/app-debug.apk`。

---

## 五、运行到设备

### 5.1 连接真机

1. 手机开启 **开发者选项** 和 **USB 调试**。
2. 用 USB 连接电脑，手机端允许「允许 USB 调试」。
3. 在 Android Studio 顶部设备下拉框中应出现该设备。

### 5.2 使用模拟器

1. **Tools → Device Manager**。
2. 点击 **Create Device**，选择机型与系统镜像（建议 API 34），完成创建。
3. 在 Device Manager 中点击该模拟器旁的 **Run** 启动。

### 5.3 运行应用

1. 在顶部工具栏选择目标设备（真机或已启动的模拟器）。
2. 点击绿色 **Run** 按钮（或 **Run → Run 'app'**，快捷键 **Shift+F10** / **Ctrl+R**）。
3. 等待安装并启动，应用会出现在设备上。

---

## 六、首次使用应用内配置

运行成功后：

1. 在应用中点击右上角 **设置（齿轮）**。
2. 在配置页填写并保存：
   - **GITHUB_TOKEN**：GitHub 个人访问令牌（需 repo 权限）
   - **GITHUB_USERNAME**：用户名
   - **GITHUB_REPO**：仓库名
   - **GITHUB_BRANCH**：分支（默认 `main`）
3. 保存后即可在列表中拉取笔记、编辑保存、删除。

---

## 七、常见问题

| 现象 | 处理建议 |
|------|----------|
| Gradle sync 失败、依赖下载超时 | 检查网络；可配置代理或国内镜像（如阿里云 Maven）。 |
| 提示 JDK 版本不对 | 在 **File → Settings → Gradle** 中将 **Gradle JDK** 设为 17。 |
| 找不到设备 | 确认 USB 调试已开启；或 **Tools → Device Manager** 中创建/启动模拟器。 |
| 编译报 Kotlin/Compose 相关错误 | **File → Invalidate Caches → Invalidate and Restart** 后重试。 |
| 项目没有 gradlew | 使用 Android Studio 自带的 Gradle 同步与运行即可，无需单独生成 gradlew。 |

---

## 八、步骤速览

```
安装 Android Studio + JDK 17 + SDK
        ↓
用 Android Studio 打开 homo_android 文件夹
        ↓
File → Sync Project with Gradle Files
        ↓
选择设备（真机或模拟器）→ 点击 Run 运行
        ↓
在应用内设置中填写 GitHub 四项配置并保存
```

更多功能说明见项目根目录 **README.md**。
